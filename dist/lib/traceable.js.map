{"version":3,"sources":["traceable.js"],"names":["Object","defineProperty","exports","value","traceable","arg","key","dtor","_traceable","flag","target","wrap","fn","callback","undefined","tn","args","T","global","_console","console","name","constructor","setTimeout","group","length","debug","result","apply","groupEnd","el","hasOwnProperty","get","set","default"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;;AACAA,OAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C,EAAEC,OAAO,IAAT,EAA7C;AACA,SAASC,SAAT,CAAmBC,GAAnB,EAAwBC,GAAxB,EAA6BC,IAA7B,EAAmC;AAC/B,QAAI,OAAOF,GAAP,KAAe,SAAnB,EAA8B;AAC1B,eAAOG,WAAWH,GAAX,CAAP;AACH,KAFD,MAGK;AACDG,mBAAW,IAAX,EAAiBH,GAAjB,EAAsBC,GAAtB,EAA2BC,IAA3B;AACH;AACJ;AACDL,QAAQE,SAAR,GAAoBA,SAApB;AACA,SAASI,UAAT,CAAoBC,IAApB,EAA0B;AACtB,WAAO,UAAUC,MAAV,EAAkBJ,GAAlB,EAAuBC,IAAvB,EAA6B;AAChC,YAAMI,OAAO,SAAPA,IAAO,CAACC,EAAD,EAAKC,QAAL,EAAkB;AAC3B,gBAAI,CAACJ,IAAL,EAAW;AACPG,mBAAG,SAAH,IAAgB,KAAhB;AACH,aAFD,MAGK;AACD,oBAAIA,GAAG,SAAH,MAAkBE,SAAtB,EAAiC;AAC7BF,uBAAG,SAAH,IAAgB,IAAhB;AACA,wBAAMG,KAAK,SAALA,EAAK,GAAmB;AAAA,0DAANC,IAAM;AAANA,gCAAM;AAAA;;AAC1B,4BAAMC,IAAIC,OAAO,OAAP,CAAV;AACA,4BAAID,MAAM,KAAN,IAAeA,CAAnB,EAAsB;AAClB,gCAAME,WAAWD,OAAO,SAAP,IACXA,OAAO,SAAP,CADW,GAEXE,OAFN;AAGA,gCAAMC,OAAOX,OAAOY,WAAP,IACTZ,OAAOY,WAAP,CAAmBD,IADV,IACkB,GAD/B;AAEAE,uCAAW,YAAM;AACbJ,yCAASK,KAAT,CAAkBH,IAAlB,SAA0Bf,GAA1B;AACA,oCAAIU,KAAKS,MAAL,GAAc,CAAlB,EAAqB;AACjBN,6CAASO,KAAT,iBAAkBV,IAAlB;AACH;AACD,oCAAIW,WAAWb,SAAf,EAA0B;AACtBK,6CAASO,KAAT,CAAeC,MAAf;AACH;AACJ,6BARD,EAQGV,KAAK,CARR;AASA,gCAAMU,SAASf,GAAGgB,KAAH,CAAS,IAAT,EAAeZ,IAAf,CAAf;AACAO,uCAAW,YAAM;AACbJ,yCAASU,QAAT;AACH,6BAFD,EAEGZ,KAAK,CAFR;AAGA,mCAAOU,MAAP;AACH,yBApBD,MAqBK;AACD,mCAAOf,GAAGgB,KAAH,CAAS,IAAT,EAAeZ,IAAf,CAAP;AACH;AACJ,qBA1BD;AA2BA,yBAAK,IAAMc,EAAX,IAAiBlB,EAAjB,EAAqB;AACjB,4BAAIA,GAAGmB,cAAH,CAAkBD,EAAlB,CAAJ,EAA2B;AACvBf,+BAAGe,EAAH,IAASlB,GAAGkB,EAAH,CAAT;AACH;AACJ;AACDjB,6BAASE,EAAT;AACH;AACJ;AACJ,SA1CD;AA2CA,YAAIR,IAAJ,EAAU;AACN,gBAAI,OAAOA,KAAKJ,KAAZ,KAAsB,UAA1B,EAAsC;AAClCQ,qBAAKJ,KAAKJ,KAAV,EAAiB,UAACY,EAAD,EAAQ;AACrBR,yBAAKJ,KAAL,GAAaY,EAAb;AACH,iBAFD;AAGH,aAJD,MAKK;AACD,oBAAI,OAAOR,KAAKyB,GAAZ,KAAoB,UAAxB,EAAoC;AAChCrB,yBAAKJ,KAAKyB,GAAV,EAAe,UAACjB,EAAD,EAAQ;AACnBR,6BAAKyB,GAAL,GAAWjB,EAAX;AACH,qBAFD;AAGH;AACD,oBAAI,OAAOR,KAAK0B,GAAZ,KAAoB,UAAxB,EAAoC;AAChCtB,yBAAKJ,KAAK0B,GAAV,EAAe,UAAClB,EAAD,EAAQ;AACnBR,6BAAK0B,GAAL,GAAWlB,EAAX;AACH,qBAFD;AAGH;AACJ;AACJ,SAlBD,MAmBK;AACDJ,iBAAKD,OAAOJ,GAAP,CAAL,EAAkB,UAACS,EAAD,EAAQ;AACtBL,uBAAOJ,GAAP,IAAcS,EAAd;AACH,aAFD;AAGH;AACJ,KApED;AAqEH;AACDb,QAAQgC,OAAR,GAAkB9B,SAAlB","file":"traceable.js","sourcesContent":["\"use strict\";\r\n/* tslint:disable:ban-types */\r\n/* tslint:disable:no-string-literal */\r\n/* tslint:disable:only-arrow-functions */\r\n/* tslint:disable:trailing-comma */\r\n/* tslint:disable:variable-name */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction traceable(arg, key, dtor) {\r\n    if (typeof arg === \"boolean\") {\r\n        return _traceable(arg);\r\n    }\r\n    else {\r\n        _traceable(true)(arg, key, dtor);\r\n    }\r\n}\r\nexports.traceable = traceable;\r\nfunction _traceable(flag) {\r\n    return function (target, key, dtor) {\r\n        const wrap = (fn, callback) => {\r\n            if (!flag) {\r\n                fn[\"_traced\"] = false;\r\n            }\r\n            else {\r\n                if (fn[\"_traced\"] === undefined) {\r\n                    fn[\"_traced\"] = true;\r\n                    const tn = function (...args) {\r\n                        const T = global[\"TRACE\"];\r\n                        if (T !== false && T) {\r\n                            const _console = global[\"CONSOLE\"]\r\n                                ? global[\"CONSOLE\"]\r\n                                : console;\r\n                            const name = target.constructor &&\r\n                                target.constructor.name || \"@\";\r\n                            setTimeout(() => {\r\n                                _console.group(`${name}.${key}`);\r\n                                if (args.length > 0) {\r\n                                    _console.debug(...args);\r\n                                }\r\n                                if (result !== undefined) {\r\n                                    _console.debug(result);\r\n                                }\r\n                            }, T || 0);\r\n                            const result = fn.apply(this, args);\r\n                            setTimeout(() => {\r\n                                _console.groupEnd();\r\n                            }, T || 0);\r\n                            return result;\r\n                        }\r\n                        else {\r\n                            return fn.apply(this, args);\r\n                        }\r\n                    };\r\n                    for (const el in fn) {\r\n                        if (fn.hasOwnProperty(el)) {\r\n                            tn[el] = fn[el];\r\n                        }\r\n                    }\r\n                    callback(tn);\r\n                }\r\n            }\r\n        };\r\n        if (dtor) {\r\n            if (typeof dtor.value === \"function\") {\r\n                wrap(dtor.value, (tn) => {\r\n                    dtor.value = tn;\r\n                });\r\n            }\r\n            else {\r\n                if (typeof dtor.get === \"function\") {\r\n                    wrap(dtor.get, (tn) => {\r\n                        dtor.get = tn;\r\n                    });\r\n                }\r\n                if (typeof dtor.set === \"function\") {\r\n                    wrap(dtor.set, (tn) => {\r\n                        dtor.set = tn;\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            wrap(target[key], (tn) => {\r\n                target[key] = tn;\r\n            });\r\n        }\r\n    };\r\n}\r\nexports.default = traceable;\r\n"]}