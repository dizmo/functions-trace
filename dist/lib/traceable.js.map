{"version":3,"sources":["traceable.js"],"names":["Object","defineProperty","exports","value","traceable","arg","key","dtor","_traceable","flag","target","wrap","fn","callback","gn","_traced","undefined","tn","args","trace","global","TRACE","_console","CONSOLE","console","name","constructor","setTimeout","group","length","debug","result","apply","groupEnd","el","hasOwnProperty","get","set","default"],"mappings":"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","file":"traceable.js","sourcesContent":["\"use strict\";\n/* tslint:disable:ban-types */\n/* tslint:disable:no-string-literal */\n/* tslint:disable:only-arrow-functions */\n/* tslint:disable:trailing-comma */\n/* tslint:disable:variable-name */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction traceable(arg, key, dtor) {\n    if (typeof arg === \"boolean\") {\n        return _traceable(arg);\n    }\n    else {\n        _traceable(true)(arg, key, dtor);\n    }\n}\nexports.traceable = traceable;\nfunction _traceable(flag) {\n    return function (target, key, dtor) {\n        const wrap = (fn, callback) => {\n            const gn = fn;\n            if (!flag) {\n                gn._traced = false;\n            }\n            else {\n                if (gn._traced === undefined) {\n                    gn._traced = true;\n                    const tn = function (...args) {\n                        const trace = global.TRACE;\n                        if (trace !== false && trace) {\n                            const _console = global.CONSOLE\n                                ? global.CONSOLE\n                                : console;\n                            const name = target.constructor &&\n                                target.constructor.name || \"@\";\n                            setTimeout(() => {\n                                _console.group(`${name}.${key}`);\n                                if (args.length > 0) {\n                                    _console.debug(...args);\n                                }\n                                if (result !== undefined) {\n                                    _console.debug(result);\n                                }\n                            }, global.TRACE || 0);\n                            const result = gn.apply(this, args);\n                            setTimeout(() => {\n                                _console.groupEnd();\n                            }, global.TRACE || 0);\n                            return result;\n                        }\n                        else {\n                            return gn.apply(this, args);\n                        }\n                    };\n                    for (const el in gn) {\n                        if (gn.hasOwnProperty(el)) {\n                            tn[el] = gn[el];\n                        }\n                    }\n                    callback(tn);\n                }\n            }\n        };\n        if (dtor) {\n            if (typeof dtor.value === \"function\") {\n                wrap(dtor.value, (tn) => {\n                    dtor.value = tn;\n                });\n            }\n            else {\n                if (typeof dtor.get === \"function\") {\n                    wrap(dtor.get, (tn) => {\n                        dtor.get = tn;\n                    });\n                }\n                if (typeof dtor.set === \"function\") {\n                    wrap(dtor.set, (tn) => {\n                        dtor.set = tn;\n                    });\n                }\n            }\n        }\n        else {\n            wrap(target[key], (tn) => {\n                target[key] = tn;\n            });\n        }\n    };\n}\nexports.default = traceable;\n"]}